name: Dev - Build & Deploy

on:
  push:
    branches-ignore:
      - main
      - stage
      - release-main-**
    paths-ignore:
      - '.gitignore'
      - 'README.md'

jobs:
  build:
    uses: ./.github/workflows/general-build.yaml
    secrets: inherit
    with:
      image_tag: ${{ github.ref_name }}-${{ github.sha }}
  deploy:
    needs: build
    uses: ./.github/workflows/general-deploy.yaml
    secrets: inherit
    with:
      environment: dev
      image_tag: ${{ github.ref_name }}-${{ github.sha }}
      subdomain: ${{ github.ref_name }}
